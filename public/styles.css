:root{
  --bg:#000;--card:#0f0f0f;--text:#fff;--muted:#bbb;--border:#222;--ok:#00e676;
  --warn:#ffd166;--accent:#fff;--danger:#ff4d4d;--brand-tg:#229ED9;--brand-wa:#25D366
}

/* base */
*{box-sizing:border-box}
html,body{height:100%;margin:0;background:#000;color:#fff;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial}
.layout{display:grid;grid-template-rows:auto 1fr;height:100%}
header{display:flex;align-items:center;justify-content:space-between;padding:12px 14px;border-bottom:1px solid var(--border);background:#050505;position:sticky;top:0;z-index:9999}
.brand{display:flex;align-items:center;gap:10px}
.brand img{width:36px;height:36px;border-radius:50%;border:2px solid #fff;object-fit:cover}
.status{font-size:14px;color:#ddd;display:flex;align-items:center;gap:8px;padding:6px 10px;border:1px solid #222;background:#0b0b0b;border-radius:999px}
.status-dot{width:8px;height:8px;border-radius:50%;background:#777;box-shadow:0 0 8px #777}
#map{height:100%;width:100%}

/* buttons & rails */
.sidepanel{position:absolute;right:12px;top:72px;z-index:4000;display:flex;flex-direction:column;gap:10px;pointer-events:auto}
.sidepanel-left{position:absolute;left:12px;top:220px;z-index:4000;display:flex;flex-direction:column;gap:10px;pointer-events:auto}
.iconbtn{appearance:none;cursor:pointer;text-decoration:none;border-radius:50%;width:48px;height:48px;padding:0;border:1px solid var(--border);background:#121212;color:#fff;display:grid;place-items:center;line-height:1;box-shadow:0 2px 10px rgba(0,0,0,.25);user-select:none;transition:.15s}
.iconbtn svg{width:24px;height:24px;display:block}
.iconbtn.primary{border-color:#2a2a2a;background:#fff;color:#000}
.iconbtn.warn{border-color:#333;background:#1a1a1a}
.iconbtn.subtle{background:#0b0b0b}
.iconbtn.danger{background:#2a0000;border-color:#400;color:#ff9a9a}
.iconbtn.brand-wa{background:var(--brand-wa);border-color:#1da851}
.iconbtn.brand-tg{background:var(--brand-tg);border-color:#1a8bbb}
.iconbtn.brand-waze{background:#00a8ff;border-color:#0a5f86}
.iconbtn img{width:24px;height:24px;filter:brightness(0) invert(1)}
.iconbtn:active{transform:scale(.98)}
.iconbtn[disabled]{opacity:.45;cursor:not-allowed;filter:grayscale(20%)}
.iconbtn[aria-pressed="true"]{outline:2px solid #3af}

/* legend & chips */
.lbl{background:#0b0b0b;color:#fff;border:1px solid #222;padding:4px 8px;border-radius:999px;font-size:12px;box-shadow:0 2px 10px rgba(0,0,0,.5)}
.legend{position:absolute;z-index:3000;left:12px;top:72px;background:#0b0b0b;border:1px solid #222;border-radius:10px;padding:8px 10px;color:#ddd;font-size:12px}
.legend .row{display:flex;align-items:center;gap:8px;margin:4px 0}
.dot{width:12px;height:12px;border-radius:50%}
.dot.pick{background:#41e38a;border:2px solid #093}
.dot.drop{background:#ffb84d;border:2px solid #964}
.dot.driver{background:#ff4d4d;border:2px solid #300}
.chip{position:absolute;left:12px;top:132px;z-index:3000;background:#0b0b0b;border:1px solid #222;border-radius:999px;padding:6px 10px;font-size:12px;color:#ddd}
.chip.gps{top:168px}

/* driver pulse + arrow */
.pulse{width:42px;height:42px;border-radius:50%;background:var(--danger);border:3px solid #300;box-shadow:0 0 0 0 rgba(255,77,77,0.9);animation:pulse 1.6s infinite}
@keyframes pulse{0%{box-shadow:0 0 0 0 rgba(255,77,77,0.85)}60%{box-shadow:0 0 0 26px rgba(255,77,77,0)}100%{box-shadow:0 0 0 0 rgba(255,77,77,0)}}
.driver-arrow svg{width:26px;height:26px;display:block;filter:drop-shadow(0 2px 4px rgba(0,0,0,.5))}

/* modal basics */
.modal{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;align-items:center;justify-content:center;z-index:12000}
.modal .card{background:#0f0f0f;border:1px solid #222;border-radius:16px;max-width:480px;width:calc(100% - 28px);padding:18px;box-shadow:0 10px 40px rgba(0,0,0,.6)}
.modal h3{margin:0 0 8px 0}
.modal p{margin:0 0 14px 0;color:#bbb}
.modal .actions{display:flex;gap:10px;justify-content:flex-end;margin-top:12px}
.modal .actions button{border-radius:10px;padding:10px 14px;font-weight:700;border:1px solid #333;background:#151515;color:#fff}
.modal .actions .primary{background:#fff;color:#000;border-color:#2a2a2a}
.reason-list{display:grid;gap:8px;margin:10px 0 6px 0}
.reason-item{display:flex;align-items:center;gap:10px;background:#0b0b0b;border:1px solid #222;border-radius:10px;padding:8px 10px}
.other-wrap{margin-top:8px}
.other-wrap textarea{width:100%;min-height:72px;background:#0b0b0b;border:1px solid #222;border-radius:10px;color:#fff;padding:8px;font-family:inherit;resize:vertical}

/* bottom CTA */
.bottom-cta{position:absolute;left:50%;bottom:16px;transform:translateX(-50%);z-index:5000}
#btnFinish{width:72px;height:72px;border-radius:50%;background:#fff;color:#000;border:1px solid #2a2a2a;font-weight:800;font-size:12px;letter-spacing:.3px;display:flex;align-items:center;justify-content:center;box-shadow:0 10px 30px rgba(0,0,0,.45);cursor:pointer}
#btnFinish:disabled{background:#cfcfcf;color:#666;border-color:#bdbdbd;cursor:not-allowed;opacity:.8}

/* CANCEL END SCREEN */
.end-screen{position:fixed;inset:0;background:linear-gradient(180deg,#0b0b0b 0%,#020202 100%);display:none;align-items:center;justify-content:center;z-index:15000}
.end-card{
  width:min(520px,calc(100% - 28px));
  background:radial-gradient(80% 120% at 50% -20%, rgba(255,77,77,.20), transparent 60%), #0b0b0b;
  border:1px solid #2a2a2a;
  border-radius:20px;
  padding:22px 18px;
  color:#fff;
  text-align:center;
  box-shadow:0 24px 80px rgba(0,0,0,.65);
}
.end-card h2{margin:0 0 8px 0;font-size:28px;font-weight:900;letter-spacing:.2px}
.end-card p{margin:0 0 16px 0;color:#cfcfcf}
.end-actions{display:flex;gap:10px;justify-content:center;flex-wrap:wrap}
.btn{
  border-radius:12px;padding:12px 16px;font-weight:800;border:1px solid #2a2a2a;background:#151515;color:#fff;cursor:pointer;min-width:160px
}
.btn.primary{background:#fff;color:#000;border-color:#2a2a2a}
.btn.tg{background:var(--brand-tg)}
.btn.wa{background:var(--brand-wa)}
.btn[disabled]{opacity:.5;cursor:not-allowed}

/* POI icons (pickup/drop) */
.poi-icon{pointer-events:none;}
.poi{--poi:#41e38a;--poi-rgb:65,227,138;position:relative;width:32px;height:92px}
.poi .stick{position:absolute;left:50%;bottom:18px;transform:translateX(-50%);width:8px;height:58px;background:linear-gradient(#fff,#dcdcdc);border-radius:6px;box-shadow:inset 0 0 0 1px #cfcfcf, 0 2px 6px rgba(0,0,0,.35)}
.poi .base{position:absolute;left:50%;bottom:10px;transform:translateX(-50%);width:20px;height:8px;background:#fff;opacity:.9;border-radius:10px}
.poi .head{position:absolute;left:50%;bottom:78px;transform:translateX(-50%);min-width:96px;max-width:200px;height:28px;padding:0 12px;display:flex;align-items:center;justify-content:center;border-radius:999px;background:var(--poi);color:#011;font-weight:900;font-size:13px;letter-spacing:.2px;white-space:nowrap;box-shadow:0 0 0 2px rgba(0,0,0,.45), 0 0 18px rgba(var(--poi-rgb),.85)}
.poi .head::after{content:"";position:absolute;inset:-3px;border-radius:999px;border:2px solid var(--poi);animation:poi-ping 2s ease-out infinite;opacity:.85}
@keyframes poi-ping{0%{transform:scale(1);opacity:.85}70%{transform:scale(1.15);opacity:0}100%{transform:scale(1);opacity:0}}
.poi.drop{--poi:#ffb84d;--poi-rgb:255,184,77}
.poi.drop .head{background:#fff !important;color:#000 !important;font-weight:900;box-shadow:0 0 0 2px rgba(0,0,0,.55), 0 6px 18px rgba(255,255,255,.15)}
.poi.drop .head::after{border-color:#fff;opacity:.6}

/* Hide status bar by default; JS will show it only for drivers */
header .status { display: none; }


/* ===== TRIP SUMMARY MODAL (after finish) ===== */
.summary-modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.75);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:13000
}
.summary-card{
  width:min(520px, calc(100% - 28px));
  background:#0b0b0b;
  border:1px solid #263041;
  border-radius:18px;
  padding:18px;

  color:#eef2ff;
  box-shadow:0 24px 80px rgba(0,0,0,.6);
  animation:popIn .22s ease-out
}
.summary-title{margin:0 0 6px 0;font-weight:800}
.summary-amount{font-size:40px;font-weight:900;margin:8px 0 4px 0;color:#fff}
.summary-sub{color:#c7d2fe;font-size:13px;margin:0 0 14px}
.summary-rows{display:grid;gap:8px;margin:12px 0 14px}
.summary-row{display:flex;align-items:center;justify-content:space-between;background:#0b0b0b;border:1px solid #1f2937;border-radius:12px;padding:10px 12px;color:#e5e7eb}
.summary-actions{display:flex;gap:10px;justify-content:flex-end}
@keyframes popIn{from{opacity:0;transform:scale(.96)}to{opacity:1;transform:scale(1)}}
